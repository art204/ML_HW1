# Домашнее задание № 1 по курсу Machine Learning


- Выполнена предварительная обработка признаков
  - Удалены повторяющиеся строки
  - Признак torque разделен на два числовых признака: torque_nm и max_torque_rpm
  - Заполнены пропуски в столбцах
- Выполнен простейший EDA 
  - Постороены попарные распределения всех числовых признаков. Положительная линейная зависимость наблюдается между
      engine и max_power, engine и torque_nm, max_power и torque_nm.
  - Проанализирована связь предикторов с целевой переменной. Наибольшая корреляция с целевой переменной наблюдается у признака max_power
- Обучены модели линейной регрессии
  - Обучение линейной регрессии только на вещественных признаках. 
    - Рассмотрены классическая линейная регрессия (sklearn.linear_model.LinearRegression), 
      модель с L1-регуляризацией (sklearn.linear_model.Lasso), а также модель, в которой объединены L1- и L2- регуляризация
      (sklearn.linear_model.ElasticNet). Метрики качества на тестовых данных для указанных моделей: R2 от 0.57 до 0.60,
      MSE от 2.29е11 до 2.45е11. 
    - Найдены оптимальные параметры моделей: параметр alpha для Lasso модели,
      параметры alpha и l1_ratio для ElasticNet модели. Подбор оптимальных параметров произведен путем перебора по сетке
      с помощью sklearn.model_selection.GridSearchCV с разбиением обучающей выборки на 10 фолдов. Оптимизация параметров моделей
      не дала положительного результата. Метрики остались в тех же диапазонах.
  - Обучение линейной регрессии на вещественных и категориальных признаках.
    - Категориальные признаки закодированы методом one-hot encoding
    - Выполнено обучение модели линейной регрессии с L2-регуляризацией (sklearn.linear_model.Ridge)
    - Выполнен поиск оптимального коэффициента регуляризации alpha для Ridge регрессии с помощью sklearn.model_selection.GridSearchCV.
    - Добавление категориальных признаков в модель, а также использование Ridge регрессии с оптимальным alpha дает
      небольшое улучшение метрик качаства на тестовых данных: R2=0.65, MSE=2.01е11.
- Рассчитана доля предиктов среди всех предсказанных цен на авто, отличающихся от реальных цен на эти авто не более чем на 10%.
  Для расчета этой метрики написана функция business_metrics. Для Ridge регрессии с оптимальным alpha=8 значение этой метрики составляет 0.24.
- С помощью FastAPI реализован сервис, который на вход получает признаки объектов либо в формате json, либо в csv файле,
  а на выходе выдает предсказанную стоимость для полученных объектов.
- Тестирование FastAPI сервиса выполнено в файле `HW1_Regression_with_inference.ipynb` в части № 5 `Реализация сервиса на FastAPI`,
  пункт `Тестирование сервиса`. Там же приведены скрины работы сервиса.

### Как улучшить модель
- В обучающей выборке встречаются выбросы, которые значительно отклоняются от наблюдаемой зависимости между признаками.
    Наличие выбросов в данных негативно сказывается на качестве модели. Удаление выбросов из обучающей выборки может улучшить
    показатели метрик. Другой вариант уменьшить влияние аномальных данных - это использование MAE (средняя абсолютная ошибка)
    в качестве функции потерь.
- Провести Feature Engineering, как это рекомендовано в четвертой (бонусной) части задания. Создать новые признаки на основе существующих:
  произведение, частное признаков. Отлогарифмировать некоторые признаки. Визуализации из части EDA могут помочь в понимании того, какая зависимость между признаками
  (линейная, квадратичная и т.д.).  Добавить новые признаки, например, достать каку-либо полезную информацию
  из названия авто. Попробовать другие способы заполнения пропусков. 
  